# MoodCoach üìàüß†

> Your personal AI-powered mental health companion. Advanced emotion analysis, personalized therapeutic recommendations, and comprehensive mood tracking in Spanish.

**MoodCoach** is a sophisticated mental health application that combines cutting-edge AI emotion analysis with evidence-based therapeutic techniques. The system provides personalized recommendations, comprehensive analytics, and a seamless user experience for mental wellness tracking.

## üéØ Key Features

- **ü§ñ AI-Powered Emotion Analysis**: Advanced Spanish emotion classification using fine-tuned transformers
- **üí° Intelligent Recommendation System**: Personalized therapeutic technique suggestions with cold-start and collaborative filtering
- **üìä Comprehensive Analytics**: Detailed mood tracking, trigger analysis, and trend visualization
- **üîí Secure & Private**: Row-level security with Supabase authentication
- **üé® Modern UI/UX**: Responsive design with TailwindCSS and smooth animations
- **‚ö° Real-time Updates**: Live data synchronization and instant feedback

---

## üìã Table of Contents

- [üèóÔ∏è System Architecture](#Ô∏è-system-architecture)
- [üß† AI & Recommendation System](#-ai--recommendation-system)
- [üìÅ Project Structure](#-project-structure)
- [üöÄ Getting Started](#-getting-started)
- [üîß Configuration](#-configuration)
- [üé® Frontend Features](#-frontend-features)
- [üì° API Documentation](#-api-documentation)
- [üóÑÔ∏è Database Schema](#Ô∏è-database-schema)
- [üìà Analytics & Insights](#-analytics--insights)
- [üîí Security & Privacy](#-security--privacy)
- [üöÄ Deployment](#-deployment)
- [üë• Contributing](#-contributing)

---

## üèóÔ∏è System Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    HTTP/REST    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    AI Pipeline    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Nuxt 3 Client  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ   FastAPI API   ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂  ‚îÇ  HF Transformers ‚îÇ
‚îÇ  (TypeScript)   ‚îÇ                 ‚îÇ   (Python)      ‚îÇ                   ‚îÇ   (ES Models)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                   ‚îÇ                                       ‚îÇ
         ‚îÇ                                   ‚îÇ                                       ‚îÇ
         ‚ñº                                   ‚ñº                                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    WebSocket     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    SQL Queries     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Supabase      ‚îÇ ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ  Recommendation ‚îÇ ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂  ‚îÇ   PostgreSQL    ‚îÇ
‚îÇ   (Auth/DB)     ‚îÇ                 ‚îÇ     Engine      ‚îÇ                   ‚îÇ   (Supabase)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                   ‚îÇ                                       ‚îÇ
         ‚îÇ                                   ‚îÇ                                       ‚îÇ
         ‚ñº                                   ‚ñº                                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    Analytics     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    Feedback Loop   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  TailwindCSS    ‚îÇ ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ   Vue 3 + Pinia ‚îÇ ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂  ‚îÇ  Machine Learning‚îÇ
‚îÇ   (Styling)     ‚îÇ                 ‚îÇ   (State Mgmt)  ‚îÇ                   ‚îÇ   (Improvements) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Core Components

1. **üé® Frontend** (`moodgraph-nuxt/`)
   - **Nuxt 3** with Vue 3 Composition API
   - **TypeScript** for type safety
   - **TailwindCSS** for responsive design
   - **VueUse** for utility functions
   - **Supabase** integration for auth and real-time data

2. **üîß Backend** (`api/`)
   - **FastAPI** for high-performance API
   - **HuggingFace Transformers** for emotion analysis
   - **Hybrid model system** (base + fine-tuned)
   - **CORS enabled** for cross-origin requests

3. **üóÑÔ∏è Database** (Supabase PostgreSQL)
   - **Row-level security** for user data protection
   - **Real-time subscriptions** for live updates
   - **Optimized queries** for analytics performance

---

## üß† AI & Recommendation System

### üé≠ Emotion Analysis Pipeline

The emotion analysis system uses a sophisticated hybrid approach combining **fine-tuned transformers** with **LLM-powered analysis**:

```python
# Hybrid Model Architecture
if USE_FINETUNED:
    model = AutoModelForSequenceClassification.from_pretrained("emotion_model/")
    tokenizer = AutoTokenizer.from_pretrained("emotion_model/")
else:
    model = "daveni/twitter-xlm-roberta-emotion-es"
```

#### üî¨ Fine-Tuning Process

Our emotion model is fine-tuned on a comprehensive Spanish emotion dataset:

**Dataset Composition:**
- **TASS Dataset**: 6,743 Spanish tweets with emotion labels
- **EmoEvent Dataset**: 8,409 Spanish emotional expressions
- **Combined Dataset**: 15,152 labeled samples across 7 emotions

**Data Processing Pipeline:**
```python
# Data cleaning and preprocessing
def clean_tweet(text: str) -> str:
    text = re.sub(r"https?://\S+", " ", text)            # URLs
    text = re.sub(r"@\w+", " ", text)                    # @mentions
    text = re.sub(r"#\w+", " ", text)                    # hashtags
    text = re.sub(r"\b(HASHTAG|USER)\b", " ", text, flags=re.I)
    text = re.sub(r"\s+", " ", text)
    return text.strip()
```

**Fine-Tuning Configuration:**
```python
training_args = TrainingArguments(
    output_dir            = "./emotion_model",
    evaluation_strategy   = "epoch",
    learning_rate         = 2e-5,
    per_device_train_batch_size = 16,
    num_train_epochs      = 3,
    weight_decay          = 0.01,
    metric_for_best_model = "accuracy",
)
```

**Model Performance:**
- **Base Model**: `daveni/twitter-xlm-roberta-emotion-es`
- **Fine-tuned**: Custom model trained on combined Spanish datasets
- **Accuracy**: High performance on Spanish emotional text classification
- **Emotions Detected**: joy, sadness, anger, fear, surprise, disgust, others

#### ü§ñ LLM Integration

The system integrates **OpenAI GPT-4o-mini** for advanced language understanding:

**1. Personalized Advice Generation** (`/api/advice/generate`)
```typescript
// OpenAI integration for therapeutic advice
const response = await $fetch('https://api.openai.com/v1/chat/completions', {
  method: 'POST',
  body: {
    model: 'gpt-4o-mini',
    messages: [
      { role: 'system', content: systemPrompt },
      { role: 'user', content: userPrompt }
    ],
    max_tokens: 600,
    temperature: 0.7
  }
})
```

**2. Automatic Trigger Analysis** (`/api/trigger/analyze`)
```typescript
// LLM-powered trigger categorization
const systemPrompt = `Eres un experto en psicolog√≠a que analiza texto emocional 
para identificar los desencadenantes o triggers de las emociones.

CATEGOR√çAS DE TRIGGERS DISPONIBLES:
- relaciones, trabajo, salud mental, finanzas, etc.

FORMATO DE RESPUESTA:
{
  "trigger": "descripci√≥n espec√≠fica del trigger detectado",
  "type": "una de las categor√≠as disponibles", 
  "confidence": "alto/medio/bajo"
}`
```

**LLM Usage Areas:**
- **üéØ Personalized Therapeutic Advice**: Contextual recommendations based on user's emotional state
- **üîç Trigger Detection**: Automatic categorization of emotional triggers
- **üìù Content Analysis**: Deep understanding of emotional context
- **ü§ù User Interaction**: Natural language processing for better UX

**Features:**
- **Spanish-optimized** transformer models
- **Multi-emotion detection** with confidence scores
- **Contextual understanding** of triggers and situations
- **Real-time processing** with sub-second response times
- **LLM-enhanced** advice generation and trigger analysis

### üéØ Intelligent Recommendation System

Our recommendation engine combines multiple approaches for personalized therapeutic suggestions:

#### üÜï Cold Start Strategy (< 3 interactions)
```typescript
// For new users
const recommendations = await getColdStartRecommendations(userProfile, filterByEmotions)
```

**Process:**
1. **Emotional Pattern Analysis**: Analyzes user's last 10 mood entries
2. **Popularity-Based Filtering**: Selects high-scoring techniques from database
3. **Demographic Matching**: Applies bonuses for psychological conditions
4. **Evidence-Based Prioritization**: Prioritizes techniques with high research evidence

#### ü§ù Collaborative Filtering (‚â• 3 interactions)
```typescript
// For experienced users
const collaborativeRecommendations = await getCollaborativeRecommendations(userProfile, emotions)
```

**Process:**
1. **User Similarity Detection**: Finds users with similar psychological profiles
2. **Preference Mining**: Analyzes 4+ star ratings from similar users
3. **Technique Scoring**: Combines average rating √ó user count
4. **Personalization**: Filters by current emotional state

#### üîÑ Hybrid Algorithm
```typescript
// Main recommendation function
const getRecommendedTechniques = async (userProfile, filterByEmotions?) => {
  const feedbackCount = await getUserFeedbackCount(userProfile.id)
  
  if (feedbackCount < 3) {
    return await getColdStartRecommendations(userProfile, filterByEmotions)
  } else {
    return await getCollaborativeRecommendations(userProfile, filterByEmotions)
  }
}
```

#### üìä Key Metrics
- **Precision**: Techniques match user's emotional needs
- **Personalization**: Adapts to individual psychological conditions
- **Diversity**: Ensures variety in recommendation categories
- **Feedback Loop**: Continuously improves with user ratings

---

## üìÅ Project Structure

```
moodgraph-public/
‚îú‚îÄ‚îÄ üìÅ api/                          # FastAPI Backend
‚îÇ   ‚îú‚îÄ‚îÄ üêç emotion_api.py           # Main FastAPI application
‚îÇ   ‚îú‚îÄ‚îÄ üìä notebooks/               # Jupyter notebooks for ML
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preprocessing-and-eda.ipynb
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ finetuning.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ ü§ñ emotion_model/           # Fine-tuned model checkpoint
‚îÇ   ‚îú‚îÄ‚îÄ üìã requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ üê≥ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ üß™ tests/                   # API tests
‚îú‚îÄ‚îÄ üìÅ moodgraph-nuxt/              # Nuxt 3 Frontend
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üé® assets/css/          # Global styles
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üß© components/          # Vue components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AdviceFlow.vue       # Technique recommendation flow
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RecommendationFlow.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TechniqueCard.vue
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FeedbackSection.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üîß composables/         # Reusable logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts           # Authentication
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useEmotionAnalysis.ts # Emotion processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useTherapeuticTechniques.ts # Recommendation engine
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useMoodEntries.ts    # Mood data management
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useTriggerAnalysis.ts # Trigger categorization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üóÉÔ∏è layouts/             # App layouts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üõ°Ô∏è middleware/          # Route guards
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ pages/               # Application pages
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.vue            # Dashboard
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entry.vue            # New mood entry
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ history.vue          # Mood history
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analytics.vue        # Data visualization
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recommendations.vue  # Personalized techniques
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ profile.vue          # User settings
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üîå plugins/             # Nuxt plugins
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üñ•Ô∏è server/api/          # Server API routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ advice/generate.post.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ techniques/recommend.post.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ feedback/submit.post.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üè∑Ô∏è types/               # TypeScript definitions
‚îÇ   ‚îú‚îÄ‚îÄ ‚öôÔ∏è nuxt.config.ts           # Nuxt configuration
‚îÇ   ‚îú‚îÄ‚îÄ üé® tailwind.config.js       # Tailwind CSS config
‚îÇ   ‚îî‚îÄ‚îÄ üì¶ package.json
‚îú‚îÄ‚îÄ ‚òÅÔ∏è cloudbuild.yaml              # CI/CD pipeline
‚îî‚îÄ‚îÄ üìñ README.md                    # This file
```

---

## üöÄ Getting Started

### üìã Prerequisites

- **Node.js 18+** (for Nuxt development)
- **Python 3.10+** (for FastAPI backend)
- **PostgreSQL** (via Supabase)
- **Git** for version control

### üõ†Ô∏è Local Development Setup

#### 1. Clone the Repository
```bash
git clone https://github.com/your-username/moodgraph-public.git
cd moodgraph-public
```

#### 2. Backend Setup (FastAPI)
```bash
cd api
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
uvicorn emotion_api:app --reload --port 8080
```

#### 3. Frontend Setup (Nuxt 3)
```bash
cd moodgraph-nuxt
bun install  # or npm install
bun run dev  # Starts on http://localhost:3000
```

#### 4. Database Setup (Supabase)
1. Create a new project at [supabase.com](https://supabase.com)
2. Run the SQL migrations (see `database/` folder)
3. Configure environment variables

---

## üîß Configuration

### üåç Environment Variables

#### Backend (`.env` in `api/`)
```env
# AI Model Configuration
USE_FINETUNED=true
FINETUNED_MODEL_PATH=emotion_model/
OPENAI_API_KEY=your_openai_key_here

# CORS Settings
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com
```

#### Frontend (`.env` in `moodgraph-nuxt/`)
```env
# Supabase Configuration
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# API Configuration
NUXT_PUBLIC_API_URL=http://localhost:8080
OPENAI_API_KEY=your_openai_key_here
```

---

## üé® Frontend Features

### üì± Core Pages

#### üè† Dashboard (`/`)
- **Real-time mood trends** with visual indicators
- **Today's emotional distribution** with interactive charts
- **Recent entries** with quick access
- **Weekly statistics** and streaks

#### ‚úçÔ∏è New Entry (`/entry`)
- **AI-powered emotion analysis** from text input
- **Automatic trigger detection** and categorization
- **Personalized technique recommendations** based on emotions
- **Progressive technique instructions** with step-by-step guidance

#### üìä Analytics (`/analytics`)
- **Emotion distribution charts** with time filtering
- **Trigger analysis** with category breakdown
- **Trend visualization** with interactive graphs
- **Statistical insights** and patterns

#### üéØ Recommendations (`/recommendations`)
- **Personalized technique suggestions** based on user profile
- **Cold start vs. experienced user** differentiation
- **Interactive technique exploration** with detailed instructions
- **Feedback system** for continuous improvement

#### üìö History (`/history`)
- **Paginated mood entries** with advanced filtering
- **Search functionality** across entries
- **Detailed entry views** with context
- **Export capabilities** for personal records

### üß© Key Components

#### `AdviceFlow.vue`
```vue
<!-- Intelligent technique recommendation flow -->
<AdviceFlow 
  :mood-entry="currentEntry"
  :user-profile="userProfile"
  @advice-generated="handleAdvice"
  @feedback-submitted="handleFeedback"
/>
```

#### `TechniqueCard.vue`
```vue
<!-- Individual technique display -->
<TechniqueCard 
  :technique="technique"
  @select-technique="selectTechnique"
/>
```

---

## üì° API Documentation

### üîå Core Endpoints

#### Emotion Analysis
```http
POST /predict
Content-Type: application/json

{
  "text": "Me siento muy ansioso por el trabajo"
}
```

**Response:**
```json
{
  "success": true,
  "emotions": [
    {"label": "fear", "score": 0.78, "translated": "miedo"},
    {"label": "sadness", "score": 0.45, "translated": "tristeza"},
    {"label": "anger", "score": 0.23, "translated": "enojo"}
  ],
  "model_info": {
    "name": "fine-tuned-spanish-emotions",
    "version": "1.0.0"
  }
}
```

#### Technique Recommendations
```http
POST /api/techniques/recommend
Content-Type: application/json

{
  "emotions": ["fear", "sadness"],
  "user_profile": { "id": "user_123", "psychological_conditions": ["anxiety"] }
}
```

#### Advice Generation
```http
POST /api/advice/generate
Content-Type: application/json

{
  "entryData": {
    "emotions": [...],
    "trigger": "work stress",
    "energyLevel": 4
  },
  "userProfile": {...},
  "selectedTechnique": {...}
}
```

---

## üóÑÔ∏è Database Schema

### üìä Core Tables

#### `user_profiles`
```sql
CREATE TABLE user_profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id),
  name VARCHAR NOT NULL,
  gender VARCHAR CHECK (gender IN ('masculino', 'femenino', 'otro', 'prefiero_no_decir')),
  age INTEGER,
  psychological_conditions TEXT[],
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### `mood_entries`
```sql
CREATE TABLE mood_entries (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id),
  timestamp_date TIMESTAMP DEFAULT NOW(),
  trigger TEXT NOT NULL,
  trigger_type VARCHAR,
  level INTEGER CHECK (level >= 1 AND level <= 10),
  emocion1 JSONB NOT NULL,
  emocion2 JSONB NOT NULL,
  emocion3 JSONB NOT NULL,
  advice TEXT,
  advice_generated_at TIMESTAMP,
  feedback_rating INTEGER CHECK (feedback_rating >= 1 AND feedback_rating <= 5),
  created_at TIMESTAMP DEFAULT NOW()
);
```

#### `therapeutic_techniques`
```sql
CREATE TABLE therapeutic_techniques (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR NOT NULL,
  description TEXT NOT NULL,
  instructions TEXT NOT NULL,
  category VARCHAR NOT NULL,
  evidence_level VARCHAR CHECK (evidence_level IN ('high', 'medium', 'low')),
  target_emotions TEXT[] NOT NULL,
  difficulty_level INTEGER CHECK (difficulty_level >= 1 AND difficulty_level <= 5),
  duration_minutes INTEGER,
  score INTEGER DEFAULT 0,
  tags TEXT[],
  created_at TIMESTAMP DEFAULT NOW()
);
```

#### `user_technique_feedback`
```sql
CREATE TABLE user_technique_feedback (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id),
  technique_id UUID REFERENCES therapeutic_techniques(id),
  rating INTEGER CHECK (rating >= 1 AND rating <= 5),
  comments TEXT,
  tried_at TIMESTAMP DEFAULT NOW(),
  feedback_at TIMESTAMP DEFAULT NOW()
);
```

---

## üìà Analytics & Insights

### üìä Dashboard Metrics

1. **Emotional Patterns**
   - Daily emotion distribution
   - Weekly trend analysis
   - Peak emotion times
   - Trigger correlation

2. **Progress Tracking**
   - Mood improvement over time
   - Technique effectiveness
   - User engagement metrics
   - Feedback sentiment analysis

3. **Personalization Metrics**
   - Recommendation accuracy
   - User satisfaction scores
   - Technique adoption rates
   - Collaborative filtering performance

### üîç Advanced Analytics

```typescript
// Emotion trend analysis
const emotionTrends = computed(() => {
  return analyzeEmotionTrends(entries.value, timeRange.value)
})

// Trigger pattern detection
const triggerPatterns = computed(() => {
  return detectTriggerPatterns(entries.value, userProfile.value)
})
```

---

## üîí Security & Privacy

### üõ°Ô∏è Authentication & Authorization

- **Supabase Auth** with JWT tokens
- **Row-level security** for all user data
- **API key protection** for external services
- **CORS configuration** for secure requests

### üîê Data Protection

```sql
-- Row-level security example
CREATE POLICY "Users can only see their own data" ON mood_entries
  FOR ALL USING (auth.uid() = user_id);
```

### üì± Privacy Features

- **Data encryption** at rest and in transit
- **Anonymized analytics** for system improvements
- **User data export** and deletion capabilities
- **Consent management** for data processing

---

## üöÄ Deployment

### ‚òÅÔ∏è Cloud Deployment (Recommended)

#### FastAPI Backend (Google Cloud Run)
```bash
# Build and deploy
gcloud builds submit --tag gcr.io/$PROJECT_ID/moodcoach-api
gcloud run deploy moodcoach-api \
  --image gcr.io/$PROJECT_ID/moodcoach-api \
  --platform managed \
  --allow-unauthenticated
```

#### Nuxt Frontend (Vercel)
```bash
# Connect to Vercel
vercel --prod
```

### üê≥ Docker Setup

```dockerfile
# API Dockerfile
FROM python:3.10-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["uvicorn", "emotion_api:app", "--host", "0.0.0.0", "--port", "8080"]
```

---

## üß™ Testing

### üî¨ Backend Testing
```bash
cd api
pytest tests/ -v
```

### üéØ Frontend Testing
```bash
cd moodgraph-nuxt
bun run test
```

### üìä Performance Testing
```bash
# API load testing
ab -n 1000 -c 10 http://localhost:8080/predict

# Frontend performance
bun run lighthouse
```

---

## üë• Contributing

### ü§ù Development Workflow

1. **Fork** the repository
2. **Create** a feature branch (`git checkout -b feature/amazing-feature`)
3. **Commit** your changes (`git commit -m 'Add amazing feature'`)
4. **Push** to the branch (`git push origin feature/amazing-feature`)
5. **Open** a Pull Request

### üìù Code Standards

- **Python**: PEP 8 with `black` formatting
- **TypeScript**: ESLint with Prettier
- **Commits**: Conventional Commits format
- **Documentation**: JSDoc for functions, comments for complex logic

### üèóÔ∏è Architecture Decisions

- **Monorepo structure** for easier development
- **Composable-first** Vue 3 architecture
- **Type-safe** development with TypeScript
- **Performance-optimized** with lazy loading and caching

---

## üìö Resources

### üîó Documentation Links

- [Nuxt 3 Documentation](https://nuxt.com/docs)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Supabase Documentation](https://supabase.com/docs)
- [HuggingFace Transformers](https://huggingface.co/docs/transformers)

### üéì Learning Resources

- [Vue 3 Composition API](https://vuejs.org/guide/composition-api-introduction.html)
- [TailwindCSS](https://tailwindcss.com/docs)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)

---

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## üôè Acknowledgments

- **HuggingFace** for providing excellent Spanish emotion models
- **Supabase** for the robust backend infrastructure
- **Nuxt Team** for the outstanding developer experience
- **Caffeine and L-theanine** for the energy boost


---

## üí¨ Support

For questions, issues, or contributions, please:

1. üìß Open an issue on GitHub
2. üìñ Check the documentation


**Made with ‚ù§Ô∏è for mental health and well-being**